<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <title></title>
</head>
<body>

    <h1>Version 2.3</h1>
    <canvas id="myCanvas" width="200" height="300" style="border: 5px solid #000000;"></canvas>

    <br>
    <label id="usernameLabel" for="username">Name:</label><br>
    <input type="text" id="username" name="username" value="Insert name here"><br>
    
    <input id="loginButton" type="submit" value="Submit" onclick="WriteInCanvas()">
    <input id="locationButton" type="submit" value="GetLocations" onclick="getLocation()" style="visibility: collapse;">
    <br>
    <label>Your location:</label>
    <p id="demo"></p>

    
    <button onclick="SendToCodeBehind('ole', false, 'jensen')">Click me</button>


<script>
  var x = document.getElementById("demo");

  function WriteInCanvas(){
    var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    ctx.clearRect(0, 0, 400, 600);

    if(document.getElementById("username").value == "test"){
        ctx.font = "15px Arial";
        ctx.fillText("Welcome, " + document.getElementById("username").value, 10, 30);
        document.getElementById("username").style.visibility = "collapse";
        document.getElementById("usernameLabel").style.visibility = "collapse";
        document.getElementById("loginButton").style.visibility = "collapse";
        document.getElementById("locationButton").style.visibility = "visible";
    } else {
        ctx.font = "15px Arial";
        ctx.fillText("Wrong username", 10, 30);
    }
  }
  function getLocation() {
      if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
      } else {
          x.innerHTML = "Geolocation is not supported by this browser.";
      }
  }
  function showPosition(position) {
      x.innerHTML = "Latitude: " + position.coords.latitude +
               "<br>Longitude: " + position.coords.longitude;
  }

  function SendToCodeBehind(person, isAttending, returnEmail)
        {
            var dataValue = "{ name: '" + person + "', isGoing: '" + isAttending + "', returnAddress: '" + returnEmail + "' }";
            $.ajax({
                type: "POST",
                url: "AjaxModtager.aspx/OnSubmit",
                data: dataValue,
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("Request: " + XMLHttpRequest.toString() + "\n\nStatus: " + textStatus + "\n\nError: " +   
                    errorThrown + "This doesn't work");
                },
                success: function (result) {
                    alert("We returned: " + result.d);
                }
            });
        }

</script>

</body>
</html>